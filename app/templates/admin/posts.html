{% extends "admin/index.html" %}

{% block main %}
<div class="menu">
  <a class="button create" href="{{ url_for('admin.create_post') }}">Créer un post</a>
</div>

<h2>Liste des posts</h2>

<div>
  <ul>
    {% for post in posts|reverse %}
    <li>
        {{ post.timestamp.strftime('%d/%m/%y %H:%M') }} — {{ post.title }}

        <a href="{{ url_for('admin.update_post', id=post.id) }}">Modifier</a>

        <form action="{{ url_for('admin.delete_post', id=post.id) }}" method="post">
          <input type="submit" value="Supprimer">
        </form>
    </li>
    {% endfor %}
  </ul>
</div>
{% endblock %}

{% block scripts %}
<script>
  document.querySelectorAll('input[type="submit"]').forEach(button => {
    button.addEventListener('click', (e) => {
      const r = confirm('Êtes-vous sûr⋅e de vouloir supprimer ce post ?')
      if (r !== true) e.preventDefault()
    })
  })
</script>
{% endblock %}
